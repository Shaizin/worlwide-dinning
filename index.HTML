<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Worldwide Dining Menu</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        body {
            background-color: #f8f8f8;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            transition: all 0.3s ease;
        }
        
        body.dark-mode {
            background-color: #222;
            color: #f0f0f0;
        }
        
        .header-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .language-toggle, .theme-toggle, .order-history-btn, .manager-login {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .language-toggle {
            background-color: #3498db;
            color: white;
        }
        
        .theme-toggle {
            background-color: #9b59b6;
            color: white;
        }
        
        .order-history-btn {
            background-color: #2ecc71;
            color: white;
        }
        
        .manager-login {
            background-color: #e74c3c;
            color: white;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: inherit;
            font-size: clamp(1.8rem, 3vw, 2.5rem);
        }
        
        .menu-category {
            margin-bottom: 40px;
            background: var(--bg-color, white);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        body.dark-mode .menu-category {
            background: #333;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .category-header {
            padding: 15px 20px;
            background-color: var(--category-bg, #f0f0f0);
            font-weight: 600;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        body.dark-mode .category-header {
            background-color: #444;
        }
        
        .menu-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }
        
        .menu-item {
            border-bottom: 1px solid var(--border-color, #eee);
            padding-bottom: 15px;
            position: relative;
        }
        
        body.dark-mode .menu-item {
            border-bottom-color: #555;
        }
        
        .item-name {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
        }
        
        .item-price {
            color: #e67e22;
            font-weight: 700;
        }
        
        .item-desc {
            color: var(--text-muted, #666);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        body.dark-mode .item-desc {
            color: #aaa;
        }
        
        .add-to-cart {
            background-color: #e67e22;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        
        .add-to-cart:hover {
            background-color: #d35400;
        }
        
        .cart-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }
        
        /* Square cart button implementation */
        .cart-btn {
            background-color: #e67e22;
            color: white;
            border: none;
            border-radius: 4px;
            width: 60px;
            height: 60px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }
        
        .cart-dropdown {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 350px;
            max-height: 400px;
            overflow-y: auto;
            background: var(--bg-color, white);
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            padding: 15px;
            display: none;
        }
        
        body.dark-mode .cart-dropdown {
            background: #333;
            box-shadow: 0 2px 15px rgba(0,0,0,0.3);
        }
        
        .cart-dropdown.show {
            display: block;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color, #eee);
        }
        
        body.dark-mode .cart-item {
            border-bottom-color: #555;
        }
        
        .cart-item-name {
            flex: 1;
        }
        
        .cart-item-price {
            font-weight: bold;
            color: #e67e22;
            margin-left: 10px;
        }
        
        .cart-total {
            font-weight: bold;
            margin-top: 15px;
            text-align: right;
            padding-top: 10px;
            border-top: 1px solid var(--border-color, #eee);
        }
        
        body.dark-mode .cart-total {
            border-top-color: #555;
        }
        
        .checkout-btn {
            width: 100%;
            padding: 10px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            margin-top: 15px;
            cursor: pointer;
        }
        
        .checkout-btn:hover {
            background-color: #219955;
        }
        
        .remove-item {
            color: #e74c3c;
            margin-left: 10px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
        }
        
        .quantity-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 1px solid #ddd;
            background: var(--bg-color, white);
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        body.dark-mode .quantity-btn {
            background: #444;
            border-color: #666;
            color: white;
        }
        
        .quantity {
            min-width: 20px;
            text-align: center;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #e74c3c;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            display: none;
        }
        
        .modal-content {
            background-color: var(--bg-color, white);
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        body.dark-mode .modal-content {
            background-color: #333;
        }
        
        .modal-title {
            margin-bottom: 20px;
            font-size: 1.5rem;
            color: inherit;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        body.dark-mode .form-group input, 
        body.dark-mode .form-group select,
        body.dark-mode .form-group textarea {
            background-color: #444;
            border-color: #666;
            color: white;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .modal-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .modal-btn.cancel {
            background-color: #95a5a6;
            color: white;
        }
        
        .modal-btn.submit {
            background-color: #27ae60;
            color: white;
        }
        
        .order-history-item {
            padding: 10px;
            border-bottom: 1px solid var(--border-color, #eee);
            margin-bottom: 10px;
        }
        
        body.dark-mode .order-history-item {
            border-bottom-color: #555;
        }
        
        .order-history-date {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .order-history-total {
            font-weight: bold;
            color: #e67e22;
            margin-top: 5px;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            color: inherit;
        }
        
        .payment-options {
            margin: 20px 0;
        }
        
        .payment-option {
            margin: 10px 0;
        }
        
        .payment-option input {
            margin-right: 10px;
        }
        
        .manager-dashboard {
            display: none;
        }
        
        .manager-controls {
            margin-bottom: 20px;
        }
        
        .add-item-btn {
            background-color: #3498db;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .menu-item-actions {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }
        
        .edit-item, .delete-item {
            padding: 3px 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .edit-item {
            background-color: #f39c12;
            color: white;
        }
        
        .delete-item {
            background-color: #e74c3c;
            color: white;
        }
        
        @media (max-width: 768px) {
            .menu-items {
                grid-template-columns: 1fr;
                padding: 15px;
            }
            
            .category-header {
                padding: 12px 15px;
                font-size: 1.2rem;
            }
            
            .cart-dropdown {
                width: 300px;
                max-height: 300px;
            }
            
            .header-controls {
                flex-wrap: wrap;
                gap: 10px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .menu-category {
                margin-bottom: 30px;
            }
            
            .cart-dropdown {
                width: 280px;
            }
            
            .header-controls {
                flex-direction: column;
            }
            
            .modal-content {
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="header-controls">
        <div>
            <button class="language-toggle" id="languageToggle">EN/PT</button>
            <button class="theme-toggle" id="themeToggle">🌙</button>
        </div>
        <div>
            <button class="order-history-btn" id="orderHistoryBtn">Order History</button>
            <button class="manager-login" id="managerLogin">Manager</button>
        </div>
    </div>
    
    <h1 id="mainTitle">Worldwide Dining Menu</h1>
    
    <div class="notification" id="notification">Cart limit reached (max 20 items)</div>
    
    <div id="menuContainer">
        <!-- Menu items will be loaded here -->
    </div>
    
    <!-- Square cart button implementation -->
    <div class="cart-container">
        <button class="cart-btn" id="cartBtn">
            🛒
            <span class="cart-count" id="cartCount">0</span>
        </button>
        <div class="cart-dropdown" id="cartDropdown">
            <button class="close-modal" id="closeCartDropdown">×</button>
            <div id="cartItems"></div>
            <div class="cart-total">Total: <span id="cartTotal">0</span>mt</div>
            <button class="checkout-btn" id="checkoutBtn">Checkout</button>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="modal" id="checkoutModal">
        <div class="modal-content">
            <button class="close-modal" id="closeCheckoutModal">×</button>
            <h3 class="modal-title" id="checkoutTitle">Checkout</h3>
            <div id="checkoutItems"></div>
            <div class="cart-total">Total: <span id="checkoutTotal">0</span>mt</div>
            
            <div class="form-group">
                <label for="customerName" id="nameLabel">Name:</label>
                <input type="text" id="customerName" required>
            </div>
            <div class="form-group">
                <label for="customerPhone" id="phoneLabel">Phone:</label>
                <input type="tel" id="customerPhone" required>
            </div>
            <div class="form-group">
                <label for="customerAddress" id="addressLabel">Address:</label>
                <input type="text" id="customerAddress" required>
            </div>
            
            <div class="payment-options">
                <h4 id="paymentLabel">Payment Method:</h4>
                <div class="payment-option">
                    <input type="radio" id="cash" name="payment" value="cash" checked>
                    <label for="cash" id="cashLabel">Cash on Delivery</label>
                </div>
                <div class="payment-option">
                    <input type="radio" id="card" name="payment" value="card">
                    <label for="card" id="cardLabel">Credit/Debit Card</label>
                </div>
                <div class="payment-option">
                    <input type="radio" id="mobile" name="payment" value="mobile">
                    <label for="mobile" id="mobileLabel">Mobile Payment</label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="cancelCheckout">Cancel</button>
                <button class="modal-btn submit" id="submitOrder">Place Order</button>
            </div>
        </div>
    </div>

    <!-- Order History Modal -->
    <div class="modal" id="orderHistoryModal">
        <div class="modal-content">
            <button class="close-modal" id="closeOrderHistory">×</button>
            <h3 class="modal-title" id="historyTitle">Order History</h3>
            <div id="orderHistoryList"></div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="closeHistory">Close</button>
            </div>
        </div>
    </div>

    <!-- Manager Login Modal -->
    <div class="modal" id="managerModal">
        <div class="modal-content">
            <button class="close-modal" id="closeManagerModal">×</button>
            <h3 class="modal-title" id="managerLoginTitle">Manager Login</h3>
            <div class="form-group">
                <label for="managerPassword" id="passwordLabel">Password:</label>
                <input type="password" id="managerPassword" required>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="cancelManager">Cancel</button>
                <button class="modal-btn submit" id="loginManager">Login</button>
            </div>
        </div>
    </div>

    <!-- Manager Dashboard Modal -->
    <div class="modal" id="managerDashboardModal">
        <div class="modal-content">
            <button class="close-modal" id="closeManagerDashboard">×</button>
            <h3 class="modal-title" id="dashboardTitle">Manager Dashboard</h3>
            
            <div class="manager-controls">
                <button class="add-item-btn" id="addItemBtn">Add New Item</button>
            </div>
            
            <div id="managerMenuItems">
                <!-- Manager's view of menu items will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Add/Edit Item Modal -->
    <div class="modal" id="itemModal">
        <div class="modal-content">
            <button class="close-modal" id="closeItemModal">×</button>
            <h3 class="modal-title" id="itemModalTitle">Add New Item</h3>
            
            <div class="form-group">
                <label for="itemName" id="itemNameLabel">Item Name:</label>
                <input type="text" id="itemName" required>
            </div>
            
            <div class="form-group">
                <label for="itemPrice" id="itemPriceLabel">Price (mt):</label>
                <input type="number" id="itemPrice" required>
            </div>
            
            <div class="form-group">
                <label for="itemCategory" id="itemCategoryLabel">Category:</label>
                <select id="itemCategory" required>
                    <option value="Salads">Salads</option>
                    <option value="Brunch">Brunch</option>
                    <option value="Drinks">Drinks</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="itemDescription" id="itemDescLabel">Description:</label>
                <textarea id="itemDescription" rows="3"></textarea>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="cancelItem">Cancel</button>
                <button class="modal-btn submit" id="saveItem">Save</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // State variables
            const cart = [];
            let orders = JSON.parse(localStorage.getItem('orders')) || [];
            let allOrders = JSON.parse(localStorage.getItem('allOrders')) || [];
            let menuItems = JSON.parse(localStorage.getItem('menuItems')) || [
                {
                    name: "Special Salad",
                    price: 200,
                    category: "Salads",
                    description: "Includes tomato, two eggs, 100 grams of grilled chicken"
                },
                {
                    name: "Basic Salad",
                    price: 150,
                    category: "Salads",
                    description: "Lots of tortilla and some chips"
                },
                {
                    name: "Egg on toast",
                    price: 250,
                    category: "Brunch",
                    description: "Toast with tomato and an egg on top"
                },
                {
                    name: "Baguette",
                    price: 200,
                    category: "Brunch",
                    description: "Baguette with ham and cheese"
                },
                {
                    name: "Masala Dosa",
                    price: 400,
                    category: "Brunch",
                    description: "A crispy, thin crepe filled with a spicy potato masala"
                },
                {
                    name: "Idli",
                    price: 450,
                    category: "Brunch",
                    description: "Steamed rice cakes, soft and fluffy, typically enjoyed with sambar and chutneys"
                },
                {
                    name: "Vada",
                    price: 400,
                    category: "Brunch",
                    description: "Savory lentil doughnuts, often served with a side of chutney"
                },
                {
                    name: "Masala Vada",
                    price: 500,
                    category: "Brunch",
                    description: "A variation of vada, without the hole in the middle"
                },
                {
                    name: "Vada Pav",
                    price: 400,
                    category: "Brunch",
                    description: "A vada served in a bun with chutney"
                },
                {
                    name: "Chaat",
                    price: 300,
                    category: "Brunch",
                    description: "A wide variety of spicy, tangy, and sweet street food snacks"
                },
                {
                    name: "Croissants",
                    price: 200,
                    category: "Brunch",
                    description: "Flaky, buttery pastries, often enjoyed with coffee"
                },
                {
                    name: "Tea",
                    price: 300,
                    category: "Drinks",
                    description: "Great for detox"
                },
                {
                    name: "Red tea",
                    price: 300,
                    category: "Drinks",
                    description: "No caffeine content"
                },
                {
                    name: "Espresso",
                    price: 350,
                    category: "Drinks",
                    description: "A single shot of espresso"
                },
                {
                    name: "Coffee",
                    price: 200,
                    category: "Drinks",
                    description: "Complex and nuanced flavors"
                },
                {
                    name: "Cappuccino",
                    price: 300,
                    category: "Drinks",
                    description: "A double shot of espresso with equal parts steamed milk and foam"
                },
                {
                    name: "Frapuccino",
                    price: 350,
                    category: "Drinks",
                    description: "Cookies & cream frapuccino"
                },
                {
                    name: "Muffins",
                    price: 150,
                    category: "Drinks",
                    description: "A quick and easy breakfast or snack option"
                },
                {
                    name: "Americano",
                    price: 300,
                    category: "Drinks",
                    description: "An espresso diluted with hot water, resulting in a stronger, less milky coffee"
                },
                {
                    name: "Mocha",
                    price: 300,
                    category: "Drinks",
                    description: "An espresso with chocolate powder or syrup, steamed milk, and often a layer of whipped cream"
                }
            ];
            
            let isEnglish = localStorage.getItem('language') !== 'pt';
            let isDarkMode = localStorage.getItem('theme') === 'dark';
            const MANAGER_PASSWORD = "12345";
            let currentEditingItemIndex = null;
            
            // DOM elements
            const elements = {
                body: document.body,
                mainTitle: document.getElementById('mainTitle'),
                menuContainer: document.getElementById('menuContainer'),
                cartBtn: document.getElementById('cartBtn'),
                cartDropdown: document.getElementById('cartDropdown'),
                cartItems: document.getElementById('cartItems'),
                cartCount: document.getElementById('cartCount'),
                cartTotal: document.getElementById('cartTotal'),
                checkoutBtn: document.getElementById('checkoutBtn'),
                checkoutModal: document.getElementById('checkoutModal'),
                checkoutItems: document.getElementById('checkoutItems'),
                checkoutTotal: document.getElementById('checkoutTotal'),
                submitOrder: document.getElementById('submitOrder'),
                cancelCheckout: document.getElementById('cancelCheckout'),
                closeCheckoutModal: document.getElementById('closeCheckoutModal'),
                orderHistoryBtn: document.getElementById('orderHistoryBtn'),
                orderHistoryModal: document.getElementById('orderHistoryModal'),
                orderHistoryList: document.getElementById('orderHistoryList'),
                closeHistory: document.getElementById('closeHistory'),
                closeOrderHistory: document.getElementById('closeOrderHistory'),
                managerLogin: document.getElementById('managerLogin'),
                managerModal: document.getElementById('managerModal'),
                loginManager: document.getElementById('loginManager'),
                cancelManager: document.getElementById('cancelManager'),
                closeManagerModal: document.getElementById('closeManagerModal'),
                managerDashboardModal: document.getElementById('managerDashboardModal'),
                closeManagerDashboard: document.getElementById('closeManagerDashboard'),
                addItemBtn: document.getElementById('addItemBtn'),
                managerMenuItems: document.getElementById('managerMenuItems'),
                itemModal: document.getElementById('itemModal'),
                closeItemModal: document.getElementById('closeItemModal'),
                itemName: document.getElementById('itemName'),
                itemPrice: document.getElementById('itemPrice'),
                itemCategory: document.getElementById('itemCategory'),
                itemDescription: document.getElementById('itemDescription'),
                saveItem: document.getElementById('saveItem'),
                cancelItem: document.getElementById('cancelItem'),
                notification: document.getElementById('notification'),
                languageToggle: document.getElementById('languageToggle'),
                themeToggle: document.getElementById('themeToggle'),
                closeCartDropdown: document.getElementById('closeCartDropdown'),
                
                // Translation elements
                checkoutTitle: document.getElementById('checkoutTitle'),
                nameLabel: document.getElementById('nameLabel'),
                phoneLabel: document.getElementById('phoneLabel'),
                addressLabel: document.getElementById('addressLabel'),
                paymentLabel: document.getElementById('paymentLabel'),
                cashLabel: document.getElementById('cashLabel'),
                cardLabel: document.getElementById('cardLabel'),
                mobileLabel: document.getElementById('mobileLabel'),
                historyTitle: document.getElementById('historyTitle'),
                managerLoginTitle: document.getElementById('managerLoginTitle'),
                passwordLabel: document.getElementById('passwordLabel'),
                dashboardTitle: document.getElementById('dashboardTitle'),
                itemModalTitle: document.getElementById('itemModalTitle'),
                itemNameLabel: document.getElementById('itemNameLabel'),
                itemPriceLabel: document.getElementById('itemPriceLabel'),
                itemCategoryLabel: document.getElementById('itemCategoryLabel'),
                itemDescLabel: document.getElementById('itemDescLabel')
            };

            // Initialize the app
            function init() {
                // Apply saved theme
                if (isDarkMode) {
                    elements.body.classList.add('dark-mode');
                    elements.themeToggle.textContent = '☀️';
                }
                
                // Apply saved language
                if (!isEnglish) {
                    updateLanguageUI();
                }
                
                // Load menu items
                renderMenu();
                renderManagerMenu();
                updateCart();
                setupEventListeners();
            }

            // Setup event listeners
            function setupEventListeners() {
                // Cart button toggle
                elements.cartBtn.addEventListener('click', toggleCartDropdown);
                elements.closeCartDropdown.addEventListener('click', () => elements.cartDropdown.classList.remove('show'));
                
                // Checkout button
                elements.checkoutBtn.addEventListener('click', openCheckoutModal);
                
                // Order submission
                elements.submitOrder.addEventListener('click', submitOrder);
                
                // Modal close buttons
                elements.cancelCheckout.addEventListener('click', () => elements.checkoutModal.style.display = 'none');
                elements.closeCheckoutModal.addEventListener('click', () => elements.checkoutModal.style.display = 'none');
                elements.closeHistory.addEventListener('click', () => elements.orderHistoryModal.style.display = 'none');
                elements.closeOrderHistory.addEventListener('click', () => elements.orderHistoryModal.style.display = 'none');
                elements.cancelManager.addEventListener('click', () => elements.managerModal.style.display = 'none');
                elements.closeManagerModal.addEventListener('click', () => elements.managerModal.style.display = 'none');
                elements.closeManagerDashboard.addEventListener('click', () => elements.managerDashboardModal.style.display = 'none');
                elements.closeItemModal.addEventListener('click', () => elements.itemModal.style.display = 'none');
                elements.cancelItem.addEventListener('click', () => elements.itemModal.style.display = 'none');
                
                // Order history
                elements.orderHistoryBtn.addEventListener('click', openOrderHistory);
                
                // Manager login
                elements.managerLogin.addEventListener('click', () => elements.managerModal.style.display = 'flex');
                elements.loginManager.addEventListener('click', loginManager);
                
                // Manager dashboard
                elements.addItemBtn.addEventListener('click', () => {
                    currentEditingItemIndex = null;
                    elements.itemName.value = '';
                    elements.itemPrice.value = '';
                    elements.itemCategory.value = 'Salads';
                    elements.itemDescription.value = '';
                    elements.itemModalTitle.textContent = isEnglish ? 'Add New Item' : 'Adicionar Novo Item';
                    elements.itemModal.style.display = 'flex';
                });
                
                elements.saveItem.addEventListener('click', saveMenuItem);
                
                // Theme toggle
                elements.themeToggle.addEventListener('click', toggleTheme);
                
                // Language toggle
                elements.languageToggle.addEventListener('click', toggleLanguage);
                
                // Close dropdown when clicking outside
                document.addEventListener('click', function(event) {
                    if (!elements.cartBtn.contains(event.target) && !elements.cartDropdown.contains(event.target)) {
                        elements.cartDropdown.classList.remove('show');
                    }
                    
                    if (event.target.classList.contains('modal')) {
                        event.target.style.display = 'none';
                    }
                });
            }

            // Toggle theme
            function toggleTheme() {
                isDarkMode = !isDarkMode;
                elements.body.classList.toggle('dark-mode');
                localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
                elements.themeToggle.textContent = isDarkMode ? '☀️' : '🌙';
            }

            // Toggle language
            function toggleLanguage() {
                isEnglish = !isEnglish;
                localStorage.setItem('language', isEnglish ? 'en' : 'pt');
                elements.languageToggle.textContent = isEnglish ? 'EN/PT' : 'PT/EN';
                updateLanguageUI();
                renderMenu();
                renderManagerMenu();
            }

            // Update UI elements based on language
            function updateLanguageUI() {
                // Main UI
                elements.mainTitle.textContent = isEnglish ? 'Worldwide Dining Menu' : 'Menu de Culinária Mundial';
                elements.orderHistoryBtn.textContent = isEnglish ? 'Order History' : 'Histórico de Pedidos';
                elements.managerLogin.textContent = isEnglish ? 'Manager' : 'Gerente';
                elements.checkoutBtn.textContent = isEnglish ? 'Checkout' : 'Finalizar';
                
                // Checkout modal
                elements.checkoutTitle.textContent = isEnglish ? 'Checkout' : 'Finalizar Pedido';
                elements.nameLabel.textContent = isEnglish ? 'Name:' : 'Nome:';
                elements.phoneLabel.textContent = isEnglish ? 'Phone:' : 'Telefone:';
                elements.addressLabel.textContent = isEnglish ? 'Address:' : 'Endereço:';
                elements.paymentLabel.textContent = isEnglish ? 'Payment Method:' : 'Método de Pagamento:';
                elements.cashLabel.textContent = isEnglish ? 'Cash on Delivery' : 'Dinheiro na Entrega';
                elements.cardLabel.textContent = isEnglish ? 'Credit/Debit Card' : 'Cartão de Crédito/Débito';
                elements.mobileLabel.textContent = isEnglish ? 'Mobile Payment' : 'Pagamento Móvel';
                elements.submitOrder.textContent = isEnglish ? 'Place Order' : 'Fazer Pedido';
                elements.cancelCheckout.textContent = isEnglish ? 'Cancel' : 'Cancelar';
                
                // Order history
                elements.historyTitle.textContent = isEnglish ? 'Order History' : 'Histórico de Pedidos';
                elements.closeHistory.textContent = isEnglish ? 'Close' : 'Fechar';
                
                // Manager login
                elements.managerLoginTitle.textContent = isEnglish ? 'Manager Login' : 'Login de Gerente';
                elements.passwordLabel.textContent = isEnglish ? 'Password:' : 'Senha:';
                elements.loginManager.textContent = isEnglish ? 'Login' : 'Entrar';
                elements.cancelManager.textContent = isEnglish ? 'Cancel' : 'Cancelar';
                
                // Manager dashboard
                elements.dashboardTitle.textContent = isEnglish ? 'Manager Dashboard' : 'Painel do Gerente';
                elements.addItemBtn.textContent = isEnglish ? 'Add New Item' : 'Adicionar Novo Item';
                
                // Item modal
                elements.itemModalTitle.textContent = isEnglish ? 'Add New Item' : 'Adicionar Novo Item';
                elements.itemNameLabel.textContent = isEnglish ? 'Item Name:' : 'Nome do Item:';
                elements.itemPriceLabel.textContent = isEnglish ? 'Price (mt):' : 'Preço (mt):';
                elements.itemCategoryLabel.textContent = isEnglish ? 'Category:' : 'Categoria:';
                elements.itemDescLabel.textContent = isEnglish ? 'Description:' : 'Descrição:';
                elements.saveItem.textContent = isEnglish ? 'Save' : 'Salvar';
                elements.cancelItem.textContent = isEnglish ? 'Cancel' : 'Cancelar';
            }

            // Render menu items
            function renderMenu() {
                elements.menuContainer.innerHTML = '';
                
                // Group items by category
                const categories = {};
                menuItems.forEach(item => {
                    if (!categories[item.category]) {
                        categories[item.category] = [];
                    }
                    categories[item.category].push(item);
                });
                
                // Create category sections
                for (const category in categories) {
                    const categoryElement = document.createElement('div');
                    categoryElement.className = 'menu-category';
                    
                    // Add emoji based on category
                    let emoji = '';
                    if (category === 'Salads') emoji = '🥗';
                    if (category === 'Brunch') emoji = '🥖';
                    if (category === 'Drinks') emoji = '☕️';
                    
                    categoryElement.innerHTML = `
                        <div class="category-header">${category} ${emoji}</div>
                        <div class="menu-items" id="${category.replace(/\s+/g, '-')}-items"></div>
                    `;
                    
                    const itemsContainer = categoryElement.querySelector('.menu-items');
                    
                    // Add items to category
                    categories[category].forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'menu-item';
                        itemElement.innerHTML = `
                            <div class="item-name">
                                <span>${item.name}</span>
                                <span class="item-price">${item.price}mt</span>
                            </div>
                            <div class="item-desc">${item.description}</div>
                            <button class="add-to-cart" data-name="${item.name}" data-price="${item.price}">
                                ${isEnglish ? 'Add to Cart' : 'Adicionar ao Carrinho'}
                            </button>
                        `;
                        itemsContainer.appendChild(itemElement);
                    });
                    
                    elements.menuContainer.appendChild(categoryElement);
                }
                
                // Reattach event listeners to add to cart buttons
                document.querySelectorAll('.add-to-cart').forEach(button => {
                    button.addEventListener('click', function() {
                        const name = this.getAttribute('data-name');
                        const price = parseInt(this.getAttribute('data-price'));
                        addToCart(name, price);
                    });
                });
            }

            // Render manager's view of menu items
            function renderManagerMenu() {
                elements.managerMenuItems.innerHTML = '';
                
                // Group items by category
                const categories = {};
                menuItems.forEach(item => {
                    if (!categories[item.category]) {
                        categories[item.category] = [];
                    }
                    categories[item.category].push(item);
                });
                
                // Create category sections
                for (const category in categories) {
                    const categoryElement = document.createElement('div');
                    categoryElement.className = 'menu-category';
                    
                    // Add emoji based on category
                    let emoji = '';
                    if (category === 'Salads') emoji = '🥗';
                    if (category === 'Brunch') emoji = '🥖';
                    if (category === 'Drinks') emoji = '☕️';
                    
                    categoryElement.innerHTML = `
                        <div class="category-header">${category} ${emoji}</div>
                        <div class="menu-items" id="manager-${category.replace(/\s+/g, '-')}-items"></div>
                    `;
                    
                    const itemsContainer = categoryElement.querySelector('.menu-items');
                    
                    // Add items to category
                    categories[category].forEach((item, index) => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'menu-item';
                        itemElement.innerHTML = `
                            <div class="item-name">
                                <span>${item.name}</span>
                                <span class="item-price">${item.price}mt</span>
                            </div>
                            <div class="item-desc">${item.description}</div>
                            <div class="menu-item-actions">
                                <button class="edit-item" data-index="${index}">
                                    ${isEnglish ? 'Edit' : 'Editar'}
                                </button>
                                <button class="delete-item" data-index="${index}">
                                    ${isEnglish ? 'Delete' : 'Excluir'}
                                </button>
                            </div>
                        `;
                        itemsContainer.appendChild(itemElement);
                    });
                    
                    elements.managerMenuItems.appendChild(categoryElement);
                }
                
                // Add event listeners to edit and delete buttons
                document.querySelectorAll('.edit-item').forEach(button => {
                    button.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        editMenuItem(index);
                    });
                });
                
                document.querySelectorAll('.delete-item').forEach(button => {
                    button.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        deleteMenuItem(index);
                    });
                });
            }

            // Edit menu item
            function editMenuItem(index) {
                const item = menuItems[index];
                currentEditingItemIndex = index;
                
                elements.itemName.value = item.name;
                elements.itemPrice.value = item.price;
                elements.itemCategory.value = item.category;
                elements.itemDescription.value = item.description;
                elements.itemModalTitle.textContent = isEnglish ? 'Edit Item' : 'Editar Item';
                
                elements.itemModal.style.display = 'flex';
            }

            // Delete menu item
            function deleteMenuItem(index) {
                if (confirm(isEnglish ? 'Are you sure you want to delete this item?' : 'Tem certeza que deseja excluir este item?')) {
                    menuItems.splice(index, 1);
                    saveMenuItems();
                    renderMenu();
                    renderManagerMenu();
                    showNotification(isEnglish ? 'Item deleted successfully' : 'Item excluído com sucesso');
                }
            }

            // Save menu item (add or edit)
            function saveMenuItem() {
                const name = elements.itemName.value.trim();
                const price = parseInt(elements.itemPrice.value);
                const category = elements.itemCategory.value;
                const description = elements.itemDescription.value.trim();
                
                if (!name || isNaN(price) || !category) {
                    showNotification(isEnglish ? 'Please fill all required fields' : 'Por favor preencha todos os campos obrigatórios');
                    return;
                }
                
                const newItem = {
                    name,
                    price,
                    category,
                    description
                };
                
                if (currentEditingItemIndex !== null) {
                    // Editing existing item
                    menuItems[currentEditingItemIndex] = newItem;
                } else {
                    // Adding new item
                    menuItems.push(newItem);
                }
                
                saveMenuItems();
                renderMenu();
                renderManagerMenu();
                elements.itemModal.style.display = 'none';
                
                showNotification(
                    isEnglish 
                        ? (currentEditingItemIndex !== null ? 'Item updated successfully' : 'Item added successfully')
                        : (currentEditingItemIndex !== null ? 'Item atualizado com sucesso' : 'Item adicionado com sucesso')
                );
                
                currentEditingItemIndex = null;
            }

            // Save menu items to localStorage
            function saveMenuItems() {
                localStorage.setItem('menuItems', JSON.stringify(menuItems));
            }

            // Add item to cart
            function addToCart(name, price) {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                
                if (totalItems >= 20) {
                    showNotification(isEnglish ? "Cart limit reached (max 20 items)" : "Limite do carrinho atingido (máx 20 itens)");
                    return;
                }
                
                const existingItem = cart.find(item => item.name === name);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({ name, price, quantity: 1 });
                }
                
                updateCart();
                elements.cartDropdown.classList.add('show');
            }

            // Update cart UI
            function updateCart() {
                elements.cartItems.innerHTML = '';
                elements.checkoutItems.innerHTML = '';
                let total = 0;
                let itemCount = 0;
                
                cart.forEach((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    itemCount += item.quantity;
                    
                    // Cart dropdown item
                    const cartItemElement = document.createElement('div');
                    cartItemElement.className = 'cart-item';
                    cartItemElement.innerHTML = `
                        <div class="cart-item-name">${item.name}</div>
                        <div class="quantity-controls">
                            <button class="quantity-btn minus" data-index="${index}">-</button>
                            <span class="quantity">${item.quantity}</span>
                            <button class="quantity-btn plus" data-index="${index}">+</button>
                        </div>
                        <div class="cart-item-price">${itemTotal}mt</div>
                        <div class="remove-item" data-index="${index}">×</div>
                    `;
                    elements.cartItems.appendChild(cartItemElement);
                    
                    // Checkout modal item
                    const checkoutItemElement = document.createElement('div');
                    checkoutItemElement.className = 'cart-item';
                    checkoutItemElement.innerHTML = `
                        <div class="cart-item-name">${item.name} × ${item.quantity}</div>
                        <div class="cart-item-price">${itemTotal}mt</div>
                    `;
                    elements.checkoutItems.appendChild(checkoutItemElement);
                });
                
                // Update totals
                elements.cartTotal.textContent = total;
                elements.checkoutTotal.textContent = total;
                elements.cartCount.textContent = itemCount;
                
                // Add event listeners to quantity buttons
                document.querySelectorAll('.quantity-btn.minus').forEach(button => {
                    button.addEventListener('click', function(e) {
                        e.stopPropagation(); // Prevent event from bubbling to document
                        const index = parseInt(this.getAttribute('data-index'));
                        if (cart[index].quantity > 1) {
                            cart[index].quantity -= 1;
                        } else {
                            cart.splice(index, 1);
                        }
                        updateCart();
                    });
                });
                
                document.querySelectorAll('.quantity-btn.plus').forEach(button => {
                    button.addEventListener('click', function(e) {
                        e.stopPropagation(); // Prevent event from bubbling to document
                        const index = parseInt(this.getAttribute('data-index'));
                        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                        
                        if (totalItems >= 20) {
                            showNotification(isEnglish ? "Cart limit reached (max 20 items)" : "Limite do carrinho atingido (máx 20 itens)");
                            return;
                        }
                        
                        cart[index].quantity += 1;
                        updateCart();
                    });
                });
                
                // Add event listeners to remove buttons
                document.querySelectorAll('.remove-item').forEach(button => {
                    button.addEventListener('click', function(e) {
                        e.stopPropagation(); // Prevent event from bubbling to document
                        const index = parseInt(this.getAttribute('data-index'));
                        cart.splice(index, 1);
                        updateCart();
                    });
                });
            }

            // Toggle cart dropdown
            function toggleCartDropdown() {
                elements.cartDropdown.classList.toggle('show');
            }

            // Open checkout modal
            function openCheckoutModal() {
                if (cart.length === 0) {
                    showNotification(isEnglish ? "Your cart is empty" : "Seu carrinho está vazio");
                    return;
                }
                
                elements.checkoutModal.style.display = 'flex';
                elements.cartDropdown.classList.remove('show');
            }

            // Submit order
            function submitOrder() {
                const name = document.getElementById('customerName').value.trim();
                const phone = document.getElementById('customerPhone').value.trim();
                const address = document.getElementById('customerAddress').value.trim();
                const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
                
                if (!name || !phone || !address) {
                    showNotification(isEnglish ? "Please fill all fields" : "Por favor preencha todos os campos");
                    return;
                }
                
                const order = {
                    date: new Date().toLocaleString(),
                    items: [...cart],
                    total: parseInt(elements.checkoutTotal.textContent),
                    customer: { name, phone, address },
                    paymentMethod
                };
                
                // Save to order history
                orders.push(order);
                localStorage.setItem('orders', JSON.stringify(orders));
                
                // Save to all orders (for manager)
                allOrders.push(order);
                localStorage.setItem('allOrders', JSON.stringify(allOrders));
                
                // Clear cart
                cart.length = 0;
                updateCart();
                
                // Close modal and reset form
                elements.checkoutModal.style.display = 'none';
                document.getElementById('customerName').value = '';
                document.getElementById('customerPhone').value = '';
                document.getElementById('customerAddress').value = '';
                
                // Show success message
                showNotification(isEnglish ? "Order placed successfully!" : "Pedido realizado com sucesso!");
            }

            // Open order history
            function openOrderHistory() {
                elements.orderHistoryList.innerHTML = '';
                
                if (orders.length === 0) {
                    elements.orderHistoryList.innerHTML = isEnglish ? '<p>No orders yet</p>' : '<p>Nenhum pedido ainda</p>';
                    elements.orderHistoryModal.style.display = 'flex';
                    return;
                }
                
                // Show orders in reverse chronological order
                [...orders].reverse().forEach(order => {
                    const orderElement = document.createElement('div');
                    orderElement.className = 'order-history-item';
                    
                    let itemsHtml = '';
                    order.items.forEach(item => {
                        itemsHtml += `<div>${item.name} × ${item.quantity} - ${item.price * item.quantity}mt</div>`;
                    });
                    
                    orderElement.innerHTML = `
                        <div class="order-history-date">${order.date}</div>
                        ${itemsHtml}
                        <div class="order-history-total">${isEnglish ? 'Total' : 'Total'}: ${order.total}mt</div>
                        <div>${isEnglish ? 'Payment' : 'Pagamento'}: ${order.paymentMethod}</div>
                        <div>${isEnglish ? 'Address' : 'Endereço'}: ${order.customer.address}</div>
                    `;
                    
                    elements.orderHistoryList.appendChild(orderElement);
                });
                
                elements.orderHistoryModal.style.display = 'flex';
            }

            // Manager login
            function loginManager() {
                const password = document.getElementById('managerPassword').value;
                
                if (password === MANAGER_PASSWORD) {
                    elements.managerModal.style.display = 'none';
                    document.getElementById('managerPassword').value = '';
                    elements.managerDashboardModal.style.display = 'flex';
                    showNotification(isEnglish ? "Manager login successful" : "Login de gerente bem-sucedido");
                } else {
                    showNotification(isEnglish ? "Incorrect password" : "Senha incorreta");
                }
            }

            // Show notification
            function showNotification(message) {
                elements.notification.textContent = message;
                elements.notification.style.display = 'block';
                
                setTimeout(() => {
                    elements.notification.style.display = 'none';
                }, 3000);
            }

            // Initialize the app
            init();
        });
    </script>
</body>
</html>